# Method Tracker (Beta)

**MethodTracker** is a lightweight debugging and logging tool for .NET that leverages Harmony to instrument your application at runtimeâ€”capturing method calls, performance metrics, and exceptions without modifying your source code.

In addition to the core logging functionality available via a NuGet package, a Visual Studio extension (VSIX) is available for interactive visualization, searching, and navigation of logged data.

## MethodTracker Tool

### What it does

The **MethodTracker Tool** allows you to run individual unit tests while automatically capturing detailed runtime information about method calls in your codebase. It tracks execution in a hierarchical manner, storing the following information for each method call:

- **Method Name**: Name of the invoked method.
- **Parameters**: Method parameters and their values.
- **Return Type**: Type of the returned value.
- **Return Value**: The value returned from the method.
- **Start Time**: Timestamp of method entry.
- **End Time**: Timestamp of method exit.
- **Elapsed Time**: Total time spent executing the method (including nested calls).
- **Exclusive Elapsed Time**: Execution time excluding nested method calls.
- **Memory Usage**:
  - **Memory Before**: Memory usage before method execution.
  - **Memory After**: Memory usage after method execution.
  - **Memory Increase**: Difference in memory consumption due to the method call.
- **Exceptions**: List of any exceptions thrown during method execution.
- **Children**: Nested method calls made within this method call.

All method calls are captured and structured hierarchically, giving clear insights into your test's execution flow.

---

### Usage

To use **MethodTracker Tool**, annotate your test methods as follows:

```csharp
[Fact]
public async Task Sample()
{
    MethodLogger.Initialize("Sample");

    // Your test code here

    MethodLogger.PrintJson();
}
```

Then, specify which assemblies to instrument by adding the following attribute in an assembly-level file:

```csharp
[assembly: AssemblyMarker(typeof(A_SERVICE_FROM_TARGET_ASSEMBLY))]
```

Replace `A_SERVICE_FROM_TARGET_ASSEMBLY` with a type from the assembly you'd like to track.

**Important:**
- Run only one test at a time, as Harmony patches apply globally. Running tests in parallel will cause unexpected behavior.

Use this tool in conjunction with the [MethodTracker Visualizer](https://marketplace.visualstudio.com/items?itemName=MirkoSangrigoli.MethodTrackerVisualizer).

---

## MethodTracker Visualizer (VSIX)

The MethodTracker Visualizer provides an intuitive Visual Studio extension for analyzing the detailed method call data generated by the MethodTracker Tool.

---

### Features

- **Filesystem Browser:** Select the test run you wish to analyze directly from your filesystem.

- **Hierarchical Method View:** Clearly see the sequence of method calls made during your test, structured hierarchically.

- **Advanced Search:** Quickly filter and find specific method calls. Use keywords separated by '&' to match all entered terms.

- **Exception View:** Examine exceptions thoroughly, observing where they originated, where they were handled, and their propagation through your codebase.

- **Performance View (Alpha):** Analyze exclusive execution times of individual methods to identify potential performance bottlenecks.

- **Comparer View:** Compare two different test runs side-by-side, easily identifying differences across method executions.

**Compatibility Note:**
- Requires **MethodTrackerTool version 2.1.0 or later**. [Get it here](https://www.nuget.org/packages/MethodTrackerTool/).

---

### Getting Started

1. **Install the NuGet Package:**  
   First, use the [MethodTrackerTool NuGet package](https://www.nuget.org/packages/MethodTrackerTool/) in your project to capture log data.

2. **Install the VSIX Extension:**  
   Download the latest VSIX from the [Method Tracker Visualizer GitHub Releases](https://marketplace.visualstudio.com/items?itemName=MirkoSangrigoli.MethodTrackerVisualizer) page and install it into Visual Studio.

3. **Open the Tool Window:**  
   In Visual Studio, go to **View > Other Windows > Method Tracker Visualizer** to open the log viewer and start exploring your logs.

---

### License

Method Tracker Visualizer VSIX Extension is released under the [MIT License](LICENSE).

---

*This is a beta release. The extension is actively evolving, and APIs/behavior may change.*
